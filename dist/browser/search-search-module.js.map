{"version":3,"sources":["webpack:///./src/app/search/search-detail/search-detail.component.css","webpack:///./src/app/search/search-detail/search-detail.component.html","webpack:///./src/app/search/search-detail/search-detail.component.ts","webpack:///./src/app/search/search-routing.module.ts","webpack:///./src/app/search/search.component.css","webpack:///./src/app/search/search.component.html","webpack:///./src/app/search/search.component.ts","webpack:///./src/app/search/search.module.ts","webpack:///./src/app/search/store/search.effects.ts","webpack:///./src/app/search/store/search.reducers.ts"],"names":[],"mappings":"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","file":"search-search-module.js","sourcesContent":["module.exports = \".mat-raised-button{\\n  align-self: flex-end;\\n}\\n.searchdetail{\\n  padding: 0 10vw;\\n}\\n\"","module.exports = \"<div fxLayout=\\\"column\\\" fxLayoutGap=\\\"15px\\\" class=\\\"searchdetail\\\">\\n  <p class=\\\"error\\\" *ngIf=\\\"!userInfo || !userInfo.email; else userFound\\\">User not found.</p>\\n\\n  <ng-template #userFound>\\n    <img src=\\\"{{userInfo.avatar}}\\\" alt=\\\"profile picture\\\" height=\\\"148px\\\" width=\\\"148px\\\">\\n    <mat-list>\\n      <mat-list-item><h4>Name: </h4> {{userInfo.name}}</mat-list-item>\\n      <mat-list-item><h4>Email: </h4> {{userInfo.email}}</mat-list-item>\\n      <mat-list-item><h4>DOB: </h4> {{convertToDateString(userInfo.dob)}}</mat-list-item>\\n      <mat-list-item><h4>Address: </h4> {{userInfo.address}}</mat-list-item>\\n      <mat-list-item><h4>Hobbies: </h4> {{userInfo.hobbies}}</mat-list-item>\\n      <mat-list-item *ngIf=\\\"userInfo.friends.length>0\\\"><h4>Friend(s): </h4>\\n        <mat-chip-list>\\n          <mat-chip *ngFor=\\\"let friend of userInfo.friends\\\" color=\\\"accent\\\" selected=\\\"true\\\">{{friend.name}}</mat-chip>\\n        </mat-chip-list>\\n      </mat-list-item>\\n    </mat-list>\\n    <br>\\n    <br>\\n    <button mat-raised-button color=\\\"primary\\\" [disabled]=\\\"friendRequestToggle\\\" (click)=\\\"sendFriendRequest()\\\">{{friendRequestStr}}</button>\\n  </ng-template>\\n</div>\\n\"","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { ActivatedRoute, Params } from '@angular/router';\nimport { Store } from '@ngrx/store';\nimport * as fromApp from '../../store/app.reducers';\nimport * as SearchActions from '../store/search.actions';\nimport { take } from 'rxjs/operators';\nimport { User } from '../../models/user.model';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'app-search-detail',\n  templateUrl: './search-detail.component.html',\n  styleUrls: ['./search-detail.component.css']\n})\nexport class SearchDetailComponent implements OnInit, OnDestroy {\n\n  userInfo: User;\n  routeSubs: Subscription;\n\n  friendRequestStr = 'Send friend\\'s request';\n  friendRequestToggle = false;\n\n  constructor(private route: ActivatedRoute, private store: Store<fromApp.AppState>) { }\n\n  ngOnInit() {\n    this.routeSubs = this.route.params.subscribe(\n      (params: Params) => {\n        let index = Number(params['index']);\n\n        //clear this userInfo if index is null\n        if(index===null||index===undefined) return this.userInfo = null;\n\n        this.friendRequestStr = 'Send friend\\'s request';\n        this.friendRequestToggle = false;\n\n        this.store.select('search','usersList').pipe(\n          take(1)\n        ).subscribe(\n          (usersList : User[])=>{\n            if(usersList.length>0&&usersList[index]){\n              this.userInfo = usersList[index];\n\n              this.store.select('auth','email').pipe(\n                take(1)\n              ).subscribe(\n                (myemail: string)=>{\n                  //check if this user is me\n                  if(this.userInfo.email===myemail) return this.disableFriendRequest('Eh?? Si moi!');\n                  //check if this user's friend including me\n                  const alreadyFriend = this.userInfo.friends.filter((user)=>user.email===myemail)\n                  if(alreadyFriend.length>0)this.disableFriendRequest('Mon Ami(e)!!');\n                  //check if this user's friend requests has me\n                  const reqUserSent = this.userInfo.friends_requests.filter((user)=>user.email===myemail)\n                  if(reqUserSent.length>0) this.disableFriendRequest('Friend\\'s request sent');\n                }\n              );\n            }\n          }\n        )\n      }\n    );\n  }\n\n  convertToDateString(date){\n    return (new Date(date)).toDateString();\n  }\n\n  sendFriendRequest(){\n    this.store.dispatch(new SearchActions.SendFriendRequest({email: this.userInfo.email, name: this.userInfo.name}));\n\n    this.disableFriendRequest('Friend\\'s request sent');\n  }\n\n  disableFriendRequest(buttonStr: string){\n    this.friendRequestStr = buttonStr;\n    this.friendRequestToggle = true;\n  }\n\n  ngOnDestroy(){\n    if(this.routeSubs)this.routeSubs.unsubscribe();\n  }\n\n}\n","import { Routes, RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { SearchComponent } from './search.component';\nimport { SearchDetailComponent } from './search-detail/search-detail.component';\n\nconst searchRoutes: Routes = [\n  {path: '', component: SearchComponent,\n  children:[\n    {path: ':username/:index', component: SearchDetailComponent}\n  ]}\n]\n\n@NgModule({\n  imports:[\n    RouterModule.forChild(searchRoutes)\n  ],\n  exports: [RouterModule]\n})\n\nexport class SearchRoutingModule{}\n","module.exports = \"a:link{\\n  text-decoration: none\\n}\\n\\na.result{\\n  max-width:148px;\\n  margin-bottom: 10px;\\n  cursor: pointer\\n}\\n\\n.searchresults{\\n  height: 80vh;\\n  width: 100%;\\n  overflow: auto;\\n}\\n\\nform{\\n  margin: 2vh auto;\\n  max-width: 80vw;\\n}\\n\\n.mat-form-field{\\n  width: 60vw;\\n}\\n\"","module.exports = \"<div fxLayout=\\\"column\\\" fxLayoutGap=\\\"1vh\\\" fxLayoutAlign=\\\"center\\\">\\n  <form [formGroup]=\\\"searchForm\\\">\\n    <mat-form-field>\\n      <input matInput placeholder=\\\"Search by user name\\\" formControlName=\\\"search\\\">\\n    </mat-form-field>\\n    <p class=\\\"error\\\" *ngIf=\\\"searchErrorState\\\">{{searchErrorState|async}}</p>\\n  </form>\\n  <div fxLayout=\\\"row\\\" fxLayoutGap=\\\"15px\\\" fxLayoutAlign=\\\"center\\\">\\n    <div fxLayout=\\\"column\\\" fxLayoutGap=\\\"15px\\\" fxFlex=\\\"20vw\\\" class=\\\"searchresults\\\" fxLayoutAlign=\\\"start end\\\">\\n      <a class=\\\"result \\\"[routerLink]=\\\"['/main/search/',user.name,i]\\\" *ngFor=\\\"let user of (usersListState|async); index as i\\\">\\n        <mat-card>\\n          <img mat-card-image height=148px src={{user.avatar}} alt={{user.name}}>\\n          <mat-card-content>\\n            <h3>Name: {{user.name}}</h3>\\n            <p>Age: {{convertToAge(user.dob)}}</p>\\n          </mat-card-content>\\n        </mat-card>\\n      </a>\\n    </div>\\n    <div fxFlex=\\\"60vw\\\">\\n      <router-outlet></router-outlet>\\n    </div>\\n  </div>\\n</div>\\n\"","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { FormGroup, FormControl } from '@angular/forms';\nimport { debounceTime } from 'rxjs/operators';\nimport { Subscription, Observable } from 'rxjs';\nimport { Store } from '@ngrx/store';\nimport * as fromApp from '../store/app.reducers';\nimport * as SearchActions from './store/search.actions';\nimport { User } from '../models/user.model';\n\n@Component({\n  selector: 'app-search',\n  templateUrl: './search.component.html',\n  styleUrls: ['./search.component.css']\n})\nexport class SearchComponent implements OnInit, OnDestroy {\n\n  searchForm = new FormGroup({\n    search: new FormControl()\n  });\n  searchFormSub: Subscription;\n  usersListState: Observable<User[]>;\n  searchErrorState: Observable<string>;\n\n  constructor(private store: Store<fromApp.AppState>) { }\n\n  ngOnInit() {\n    this.store.dispatch(new SearchActions.ClearSearch());\n\n    this.searchFormSub = this.searchForm.valueChanges.pipe(\n      debounceTime(200)\n    ).subscribe((value)=>{\n      console.log(value);\n      if(value.search==''){\n        this.store.dispatch(new SearchActions.ClearSearch());\n      }\n      if(value.search)this.store.dispatch(new SearchActions.Search(value.search));\n\n    })\n\n    this.usersListState = this.store.select('search','usersList');\n    this.searchErrorState = this.store.select('search','search_fail_message');\n  }\n\n  convertToAge(date){\n    const age = new Date(Date.now()).getFullYear() - new Date(date).getFullYear();\n    return age;\n  }\n\n  ngOnDestroy(){\n    if(this.searchFormSub) this.searchFormSub.unsubscribe();\n  }\n\n}\n","import { NgModule } from \"@angular/core\";\nimport { SharedModule } from \"../shared/shared.module\";\nimport { ReactiveFormsModule } from \"@angular/forms\";\nimport { SearchRoutingModule } from \"./search-routing.module\";\nimport { SearchComponent } from \"./search.component\";\nimport { SearchDetailComponent } from './search-detail/search-detail.component';\nimport { searchReducer } from './store/search.reducers';\nimport { SearchEffects } from './store/search.effects';\nimport { StoreModule } from \"@ngrx/store\";\nimport { EffectsModule } from \"@ngrx/effects\";\n\n@NgModule({\n  declarations:[\n    SearchComponent,\n    SearchDetailComponent\n  ],\n  imports:[\n    SearchRoutingModule,\n    SharedModule,\n    ReactiveFormsModule,\n    StoreModule.forFeature('search',searchReducer),\n    EffectsModule.forFeature([SearchEffects])\n  ]\n})\n\nexport class SearchModule {}\n","import { Injectable } from '@angular/core';\nimport {Effect, Actions} from '@ngrx/effects'\nimport { HttpClient, HttpErrorResponse } from '@angular/common/http';\nimport { environment } from '../../../environments/environment';\n\nimport * as SearchActions from './search.actions';\nimport { map, switchMap, catchError } from 'rxjs/operators';\nimport { of } from 'rxjs';\nimport { User } from '../../models/user.model';\nimport { SocketService } from '../../shared/socket.service';\nconst SERVER_PATH = environment.server;\n\n@Injectable()\nexport class SearchEffects{\n  @Effect()\n  search = this.actions$.ofType(SearchActions.SEARCH).pipe(\n    map((action: SearchActions.Search) => action.payload),//get the search string\n    switchMap((searchStr : string) =>{\n      return this.httpClient.get(SERVER_PATH+'/user/search/'+searchStr,\n            {\n                observe:'body',\n                responseType:'json'\n            }).pipe(\n            catchError(err =>{\n              console.log(\"error searching \",err);\n              return of(err);\n            })\n          );\n    }),\n    switchMap((resp)=>{\n      if (resp instanceof HttpErrorResponse){\n        console.log('search fail resp');\n        return of({type:SearchActions.SEARCH_FAIL, payload: resp['error']});\n      }\n\n      return of({type:SearchActions.UPDATE_USERS_LIST, payload: resp['users']});\n    })\n  );\n\n  @Effect()\n  sendFriendRequest = this.actions$.ofType(SearchActions.SEND_FRIEND_REQUEST).pipe(\n    map((action: SearchActions.SendFriendRequest) => action.payload),\n    switchMap((friendData: {email:string, name:string})=>{\n      return this.httpClient.post(SERVER_PATH+'/user/search/sendfriendrequest',JSON.stringify(friendData),\n              {\n                headers:{'Content-Type':'application/json'},\n                observe:'body',\n                responseType:'json'\n              }).pipe(\n              catchError(err =>{\n                console.log(\"error friend request\",err);\n                return of(err);\n              })\n            )\n    }),\n    switchMap((resp)=>{\n      if(resp instanceof HttpErrorResponse){\n        return of({type:SearchActions.SEARCH_FAIL, payload: resp['error']});\n      }else{\n        //call the socket service\n        const friend: User = resp['user'];\n        this.socketService.friendRequestSent({email:friend.email, name:friend.name});\n        return of({type:SearchActions.UPDATE_USER, payload: friend});\n      }\n    })\n  )\n\n  constructor(private actions$: Actions, private httpClient: HttpClient, private socketService: SocketService){};\n}\n","import * as SearchActions from './search.actions';\nimport * as fromApp from '../../store/app.reducers';\nimport { User } from '../../models/user.model';\n\nexport interface FeatureState extends fromApp.AppState{\n  search: State;\n}\n\nexport interface State{\n  usersList: User[];\n  search_fail_message: string;\n}\n\nconst initialState: State ={\n  usersList: new Array<User>(),\n  search_fail_message: null\n}\n\nexport function searchReducer(state=initialState, action: SearchActions.SearchActions){\n  switch(action.type){\n    case(SearchActions.CLEAR_SEARCH):\n      return{\n        ...state,\n        usersList: [],\n        search_fail_message: null\n      }\n    case(SearchActions.UPDATE_USERS_LIST):\n      return{\n        ...state,\n        usersList: [...action.payload],\n        search_fail_message: null\n      }\n    case(SearchActions.UPDATE_USER):\n      const updatedUsersList = [...state.usersList];\n      const index = updatedUsersList.findIndex((user)=>{\n        return user.email===action.payload.email && user.name===action.payload.name\n      });\n      if(index>-1)updatedUsersList[index] = action.payload;\n      return{\n        ...state,\n        usersList: updatedUsersList\n      }\n    case(SearchActions.SEARCH_FAIL):\n      return{\n        ...state,\n        search_fail_message: action.payload\n      }\n    case(SearchActions.CLEAR_STORE):\n      return{\n        ...state,\n        ...initialState\n      }\n    default:\n      return state;\n  }\n}\n"],"sourceRoot":""}